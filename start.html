
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="octokit-rest.min.js"></script>
        <script type="text/javascript">
            'use strict'
            console.log("test");

            const authStorageName = "gitHubAuth";


            function logIn(username, password) {

                // basic
                octokit.authenticate({
                  type: 'basic',
                  username: username,
                  password: password
                });
            }

            function getRequest(url){

                let auth = localStorage.getItem(authStorageName);
                if (!auth) {
                    throw "Not logged in";
                }

                return jQuery.ajax({
                    method: "GET",
                    url: url,
                    contentType:"application/vnd.github.v3.diff", 
                    headers: { Authorization: "Basic " + auth }
                });

            }

            function PullRequest(pullReuqestResponse) {
                this.api_response = pullReuqestResponse;

                this.isClosed = function() {
                    return pullReuqestResponse.closed_at === null;
                }

                this.getDiff = function() {
                    return getRequest(pullReuqestResponse.diff_url)
                }

            }

            async function GetPullRequests(repoName) {
                const data = await getRequest(`https://api.github.com/repos/${repoName}/pulls`)
                console.log(data)
                let toReturn = [];
                let count = 0;
                data.forEach(function (value) {
                    toReturn[count] = new PullRequest(value);
                    count += 1;
                });


                return toReturn;

            }

            const octokit = new Octokit()

            // Compare: https://developer.github.com/v3/repos/#list-organization-repositories
            octokit.repos.getForOrg({
              org: 'octokit',
              type: 'public'
            }).then(({data, headers, status}) => {
                console.log(data)
            })


        </script>
    </head>
    <body>
        <div id="diff"> 
            No Diff
        </div>
    </body>
</html>
